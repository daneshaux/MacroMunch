@page "/spice-level"
@inject IJSRuntime JS

<div class="header-bar">
    <span class="back-arrow" @onclick="GoBack">â†</span>
    <h3 class="h5 header-title">Finish signing up</h3>
</div>

<div class="goal-selection-container">
    <h2 class="h2">How spicy do you like your food?</h2>

    <div class="slider-wrapper">
        <input type="range" min="0" max="4" step="1" @bind="spiceLevel" class="spice-slider" />
        <div class="slider-labels">
            <span>ğŸ§Š</span>
            <span>ğŸŒ¶ï¸</span>
            <span>ğŸ”¥</span>
            <span>ğŸ¥µ</span>
            <span>ğŸ˜µâ€ğŸ’«</span>
        </div>
        <div class="spice-legend caption" style="margin-top: 16px;">
            <div>ğŸ§Š Not Spicy</div>
            <div>ğŸŒ¶ï¸ Mild</div>
            <div>ğŸ”¥ Medium</div>
            <div>ğŸ¥µ Spicy</div>
            <div>ğŸ˜µâ€ğŸ’« Extra Hot</div>
        </div>
    </div>

    <button class="primary-btn" style="margin-top: 40px;" @onclick="Continue">
        Continue
    </button>
</div>

@code {
    private int spiceLevel = 2; // default to medium
    private string userId = "testUserId"; // Replace with real user ID!

    private async Task Continue()
    {
        // Save to Firebase
        await JS.InvokeVoidAsync("firebaseInterop.saveSpiceLevel", userId, spiceLevel);

        // Navigate to the next screen
        NavigationManager!.NavigateTo("/flavor-profiles");
    }

    private async Task GoBack()
    {
        await JS.InvokeVoidAsync("history.back");
    }

    [Inject] private NavigationManager? NavigationManager { get; set; }
}